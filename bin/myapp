#!/usr/bin/env jruby
require 'net/http'
require 'newrelic_rpm'
require 'uri'

NewRelic::Agent.manual_start :app_name => 'My Jar-Test (Dev)', :agent_enabled => true

puts "Howdy!"

name = File.dirname(__FILE__)+'/../config'
puts "got: #{name}"

files = Dir.glob(name + "/*")
puts "config files: #{files}"

contents = ''
files.each do |src|
  File.open(src) do |file|
    contents = file.read
  end if File.exists?(src)
end
# puts "contents: #{contents}"
puts "===================================="

parent = File.dirname(File.dirname(__FILE__))
puts "uniform way: #{parent}"

files = Dir.glob(parent + "/config/*")
puts "config files: #{files}"

contents = ''
files.each do |src|
  File.open(src) do |file|
    contents = file.read
  end if File.exists?(src)
end
# puts "contents: #{contents}"
puts "===================================="

sites = [URI.parse("http://google.com/"), URI.parse("http://google.com/finance/"), URI.parse("http://apple.com/"), URI.parse("http://github.com/")]

10.times do
	100.times do
		sites.each do |uri|
			response = Net::HTTP.get_response(uri)
	#		Net::HTTP.get_print(uri)
		end
	end
	puts "100 down..."
end
